$.fn.userShippingAddressForm=function(){var e=$(this);if(!e.data("initialized")){e.data("initialized",!0);var r=e.find("[name='ShippingAddress']"),a=e.find("[name='SaveAddress']"),t=e.find("[name='ShippingAddressJson']"),n=e.find("[name='Fullname']"),i=e.find("[name='TelOrMobile']"),d=e.find("[name='Region']"),c=e.find("[name='ZipCode']"),o=e.find("[name='DetailedAddress']"),s="copyingLock",u="collect.userShippingAddressForm",l=function(){e.data(s,!0);var a=JSON.parse(r.val()||"{}")||{};n.val(a.ReceiverName),i.val(a.ReceiverTel),d.val(JSON.stringify({Country:a.Country,RegionId:a.RegionId})),d.closest(".region-editor").trigger("bindCountryAndRegion.RegionEditor"),c.val(a.ZipCode),o.val(a.DetailedAddress),e.data(s,!1),e.trigger(u)};r.on("change",l),e.bind(u,function(){if(!e.data(s)){var u=JSON.parse(r.val()||"{}")||{},l=JSON.parse(d.val()||"{}")||{},p={SelectedAddressId:u.Id||null,SaveAddress:a.is(":checked"),ReceiverName:n.val(),ReceiverTel:i.val(),Country:l.Country||null,RegionId:l.RegionId||null,ZipCode:c.val(),DetailedAddress:o.val()};t.val(JSON.stringify(p)).change()}}),e.find("input").not(t).on("change",function(){e.trigger(u)}),l.call(r)}},$(function(){var e=$(".cart-container"),r=e.find(".cart-product-table"),a=e.find("[name='createOrderProductParametersList']"),t=e.find("[name='cartProducts']"),n="cartProductChange.cartView",i=!1;e.on(n,function(){if(!i){i=!0;var e=[],n=0,d={};r.find(".cart-product").each(function(){var r=$(this),a=r.find(".selection input");if(a.is(":checked")){var t=r.find(".order-count input"),i=t.val()||0;if(0>=i)return void a.prop("checked",!1).change();var c=r.data("product-id"),o=r.data("matched-parameters")||"{}";o.OrderCount=parseInt(r.find(".order-count input").val())||0,e.push({ProductId:c,MatchParameters:o}),n+=o.OrderCount;var s=r.data("cart-product-id");d[s]=o.OrderCount}}),r.find(".cart-product-total .total-count > em").text(n),a.val(JSON.stringify(e)).change(),t.val(JSON.stringify(d)).change(),i=!1}}),e.on("click",".delete",function(){var r=$(this),a=r.data("id");$.post("/api/cart/delete",{id:a},function(a){$(".minicart-menu").trigger("reinitialize.miniCart"),$.handleAjaxResult(a),r.closest("[role='row']").remove(),e.trigger(n)})}),r.on("change",".selection input",function(){e.trigger(n)});var d=null;r.on("change",".order-count input",function(){e.trigger(n),clearTimeout(d),d=setTimeout(function(){$.post("/api/cart/update_counts",{counts:t.val()},function(e){$.handleAjaxResult(e)})},1e3)}),a.attr("data-order-parameter","CreateOrderProductParametersList"),t.attr("data-order-parameter","CartProducts"),e.trigger(n)}),$(function(){var e=$(".cart-container"),r=e.find(".cart-product-table"),a=e.find("[name='cartProducts']");a.on("change",function(){var t=JSON.parse(a.val()||"{}"),n=_.indexBy(r.find(".cart-product"),function(e){return $(e).data("cart-product-id")}),i=_.any(t,function(e,r){return $(n[r]).data("is-real")}),d=e.find(".shipping-address"),c=e.find(".logistics-select");i?d.removeClass("hide"):d.addClass("hide"),i?c.removeClass("hide"):c.addClass("hide")});var t=e.find(".user-shipping-address-form");t.userShippingAddressForm();var n=t.find("input[name='ShippingAddressJson']");n.attr("data-order-parameter","ShippingAddress")}),$(function(){var e=$(".cart-container");e.find("[name='OrderComment']").attr("data-order-parameter","OrderComment")}),$(function(){var e=$(".cart-container"),r=e.find(".logistics-select"),a=e.find("[name='logisticsWithSeller']");r.on("change","input[type='radio']",function(){var e={};r.each(function(){var r=$(this),a=r.data("seller-id")||0,t=r.find("input[type='radio']:checked").val();e[a]=t}),a.val(JSON.stringify(e)).change()}),r.each(function(){$(this).find("input[type='radio']").first().prop("checked",!0).change()})}),$(function(){var e=$(".cart-container"),r=e.find(".payment-api-select"),a=e.find("[name='paymentApiId']");r.on("change","input[type='radio']",function(){a.val(r.find("input[type='radio']:checked").val()).change()}),r.find("input[type='radio']").first().prop("checked",!0).change()}),$(function(){var e=$(".cart-container"),r="createOrderParametersChange.cartView",a="collectCreateOrderParametersEventName.cartView";e.on(a,function(){var a={OrderParameters:{},OrderProductParametersList:[]};e.find("[data-order-parameter]").each(function(){var e=$(this),r=e.attr("data-order-parameter"),t=$("<div>").attr("data-val",e.val()).data("val");"CreateOrderProductParametersList"==r?a.OrderProductParametersList=t:a.OrderParameters[r]=t}),console.log(a),e.data("createOrderParameters",a),e.trigger(r)}),e.on("change","[data-order-parameter]",function(){e.trigger(a)}),e.trigger(a)}),$(function(){});