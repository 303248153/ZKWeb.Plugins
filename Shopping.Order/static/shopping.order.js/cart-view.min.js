$.fn.userShippingAddressForm=function(){var e=$(this);if(!e.data("initialized")){e.data("initialized",!0);var n=e.find("[name='ShippingAddress']"),a=e.find("[name='SaveAddress']"),t=e.find("[name='ShippingAddressJson']"),i=e.find("[name='Fullname']"),r=e.find("[name='TelOrMobile']"),d=e.find("[name='Region']"),o=e.find("[name='ZipCode']"),c=e.find("[name='DetailedAddress']"),s="copyingLock",u="collect.userShippingAddressForm",l=function(){e.data(s,!0);var a=JSON.parse(n.val()||"{}")||{};i.val(a.ReceiverName),r.val(a.ReceiverTel),d.val(JSON.stringify({Country:a.Country,RegionId:a.RegionId})),d.closest(".region-editor").trigger("bindCountryAndRegion.RegionEditor"),o.val(a.ZipCode),c.val(a.DetailedAddress),e.data(s,!1),e.trigger(u)};n.on("change",l),e.bind(u,function(){if(!e.data(s)){var u=JSON.parse(n.val()||"{}")||{},l=JSON.parse(d.val()||"{}")||{},p={SelectedAddressId:u.Id||null,SaveAddress:a.is(":checked"),ReceiverName:i.val(),ReceiverTel:r.val(),Country:l.Country||null,RegionId:l.RegionId||null,ZipCode:o.val(),DetailedAddress:c.val()};t.val(JSON.stringify(p)).change()}}),e.find("input").not(t).on("change",function(){e.trigger(u)}),l.call(n)}},$(function(){var e=$(".cart-container"),n=e.find(".cart-product-table"),a=e.find("[name='createOrderProductParametersList']"),t=e.find("[name='cartProducts']"),i="cartProductChange.cartView",r=!1;e.on(i,function(){if(!r){r=!0;var e=[],i=0,d={};n.find(".cart-product").each(function(){var n=$(this),a=n.find(".selection input");if(a.is(":checked")){var t=n.find(".order-count input"),r=t.val()||0;if(0>=r)return void a.prop("checked",!1).change();var o=n.data("product-id"),c=n.data("matched-parameters")||"{}";c.OrderCount=parseInt(n.find(".order-count input").val())||0,e.push({ProductId:o,MatchParameters:c}),i+=c.OrderCount;var s=n.data("cart-product-id");d[s]=c.OrderCount}}),n.find(".cart-product-total .total-count > em").text(i),a.val(JSON.stringify(e)).change(),t.val(JSON.stringify(d)).change(),r=!1}}),e.on("click",".delete",function(){var n=$(this),a=n.data("id");$.post("/api/cart/delete",{id:a},function(a){$(".minicart-menu").trigger("reinitialize.miniCart"),$.handleAjaxResult(a),n.closest("[role='row']").remove(),e.trigger(i)})}),n.on("change",".selection input",function(){e.trigger(i)});var d=null;n.on("change",".order-count input",function(){e.trigger(i),clearTimeout(d),d=setTimeout(function(){$.post("/api/cart/update_counts",{counts:t.val()},function(e){$.handleAjaxResult(e)})},1e3)}),a.attr("data-order-parameter","CreateOrderProductParametersList"),t.attr("data-order-parameter","CartProducts"),e.trigger(i)}),$(function(){var e=$(".cart-container"),n=e.find(".cart-product-table"),a=e.find("[name='cartProducts']");a.on("change",function(){var t=JSON.parse(a.val()||"{}"),i=_.indexBy(n.find(".cart-product"),function(e){return $(e).data("cart-product-id")}),r=_.any(t,function(e,n){return $(i[n]).data("is-real")}),d=e.find(".shipping-address"),o=e.find(".logistics-select");r?d.removeClass("hide"):d.addClass("hide"),r?o.removeClass("hide"):o.addClass("hide")});var t=e.find(".user-shipping-address-form");t.userShippingAddressForm();var i=t.find("input[name='ShippingAddressJson']");i.attr("data-order-parameter","ShippingAddress")}),$(function(){var e=$(".cart-container");e.find("[name='OrderComment']").attr("data-order-parameter","OrderComment")}),$(function(){var e=$(".cart-container"),n=e.find(".logistics-select"),a=e.find("[name='logisticsWithSeller']");n.on("change","input[type='radio']",function(){var e={};n.each(function(){var n=$(this),a=n.data("seller-id"),t=n.find("input[type='radio']:checked").val();e[a]=t}),a.val(JSON.stringify(e))}),n.each(function(){$(this).find("input[type='radio']").first().prop("checked",!0).change()})}),$(function(){var e=$(".cart-container"),n=e.find(".payment-api-select"),a=e.find("[name='paymentApiId']");n.on("change","input[type='radio']",function(){a.val(n.find("input[type='radio']:checked").val()).change()}),n.find("input[type='radio']").first().prop("checked",!0).change()});