$(function(){var t=$(".cart-container"),r=t.find(".cart-product-table"),a="cartProductChange.cartView";t.on(a,function(){var a=[],e=!1,n=0,i={};r.find(".cart-product").each(function(){var t=$(this),r=t.data("product-id"),c=t.data("matched-parameters")||"{}";c.OrderCount=parseInt(t.find(".order-count input").val())||0,a.push({ProductId:r,MatchParameters:c}),t.data("is-real")&&(e=!0),n+=c.OrderCount;var o=t.data("cart-product-id");i[o]=c.OrderCount}),e||(t.find(".shipping-address").remove(),t.find(".logistics-select").remove()),r.find(".cart-product-total .total-count > em").text(n);var c=t.find("[name='createOrderProductParameters']");c.val(JSON.stringify(a)).change();var o=t.find("[name='cartProducts']");o.val(JSON.stringify(i)).change()}),t.on("click",".delete",function(){var r=$(this),e=r.data("id");$.post("/api/cart/delete",{id:e},function(e){$(".minicart-menu").trigger("reinitialize.miniCart"),$.handleAjaxResult(e),r.closest("[role='row']").remove(),t.trigger(a)})});var e=null;r.on("change",".order-count input",function(){t.trigger(a),clearTimeout(e),e=setTimeout(function(){var r=t.find("[name='cartProducts']");$.post("/api/cart/update_counts",{counts:r.val()},function(t){$.handleAjaxResult(t)})},1e3)}),t.trigger(a)});