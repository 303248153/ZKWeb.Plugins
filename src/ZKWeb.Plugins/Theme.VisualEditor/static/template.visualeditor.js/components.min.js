$(function(){window.VisualEditorData={widgetGroups:[],widgetPathToWidgetInfo:{}},window.VisualEditor={init:function(){VisualEditorData.widgetGroups=$(".visual-editor-top-bar .metadata .widget-groups").data("widget-groups")||[],$.each(VisualEditorData.widgetGroups,function(t,e){$.each(e.Widgets,function(t,e){VisualEditorData.widgetPathToWidgetInfo[e.WidgetInfo.WidgetPath]=e.WidgetInfo})})},parseWidgetElement:function(t){var e=t.attr("data-widget")||"",i=e.indexOf("{");return i>=0?{path:e.substr(0,i),args:e.substr(i)}:{path:e,args:null}},getWidgetInfo:function(t){return VisualEditorData.widgetPathToWidgetInfo[t]||{}}},$(document).on("visual-editor-loaded",function(){VisualEditor.init()})}),$(function(){var t=function(t){return t.preventDefault&&t.preventDefault(),!1},e=function(){$.toast("TODO")},i=function(){$.toast("TODO")},a=function(){BootstrapDialog.showRemote($(this).text().trim(),"/api/visual_editor/get_switch_pages",{type:"type-warning",size:"size-normal"})},n=function(){$.toast("TODO")},o=function(){var t=$(this),e=VisualEditor.parseWidgetElement(t),i=VisualEditor.getWidgetInfo(e.path),a=$("<div>").addClass("template-widget-title-bar");a.append($("<span>").addClass("name").text($.translate(i.Name))),a.prependTo(t)},d=function(){var t=$(this);t.find(".template-widget-title-bar").remove()};$(document).on("visual-editor-loaded",function(){var u=$("body *:not(.visual-editor-top-bar):not(.modal) *");u.unbind("click").unbind("mouseenter").unbind("mouseleave"),u.bind("click",t);var r=$(".visual-editor-top-bar");r.find(".add-element").on("click",e),r.find(".manage-theme").on("click",i),r.find(".switch-page").on("click",a),r.find(".save-changes").on("click",n),$(document).on("mouseenter",".template_widget",o),$(document).on("mouseleave",".template_widget",d)})}),$(function(){$("body").append($("<div>").addClass("visual-editor-loading")),$.ajax({url:"/api/visual_editor/get_top_bar",cache:!1,success:function(t){var e=$(t).prependTo("body");setTimeout(function(){$(document).trigger("visual-editor-loaded"),$(document).trigger("dynamicLoaded",e),setTimeout(function(){$(".visual-editor-loading").remove()},250)},100)}})});